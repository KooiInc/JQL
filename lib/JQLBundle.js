var De="url('data:image/svg+xml\\3butf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22iso-8859-1%22%3F%3E%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20version%3D%221.1%22%20id%3D%22Layer_1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20128%20128%22%20style%3D%22enable-background%3Anew%200%200%20128%20128%3B%22%20xml%3Aspace%3D%22preserve%22%3E%3Crect%20x%3D%22-368%22%20y%3D%226%22%20style%3D%22display%3Anone%3Bfill%3A%23E0E0E0%3B%22%20width%3D%22866%22%20height%3D%221018%22%2F%3E%3Ccircle%20style%3D%22fill%3A%23FFFFFF%3B%22%20cx%3D%2264%22%20cy%3D%2264%22%20r%3D%2248%22%2F%3E%3Ccircle%20style%3D%22fill%3A%238CCFB9%3B%22%20cx%3D%2264%22%20cy%3D%2264%22%20r%3D%2239%22%2F%3E%3Ccircle%20style%3D%22fill%3Anone%3Bstroke%3A%23444B54%3Bstroke-width%3A6%3Bstroke-miterlimit%3A10%3B%22%20cx%3D%2264%22%20cy%3D%2264%22%20r%3D%2248%22%2F%3E%3Cpolyline%20style%3D%22fill%3Anone%3Bstroke%3A%23FFFFFF%3Bstroke-width%3A6%3Bstroke-linecap%3Around%3Bstroke-miterlimit%3A10%3B%22%20points%3D%2242%2C69%2055.55%2C81%20%20%2086%2C46%20%22%2F%3E%3C%2Fsvg%3E')",Y=Pe(),fe=Je(),z=Oe(),q=ke();function Oe(){return{html:"accept,action,align,alt,autocapitalize,autocomplete,autopictureinpicture,autoplay,background,bgcolor,border,capture,cellpadding,cellspacing,checked,cite,class,clear,contenteditable,color,cols,colspan,controls,controlslist,coords,crossorigin,datetime,decoding,default,dir,disabled,disablepictureinpicture,disableremoteplayback,download,draggable,enctype,enterkeyhint,face,for,headers,height,hidden,high,href,hreflang,id,inputmode,integrity,ismap,kind,label,lang,list,loading,loop,low,max,maxlength,media,method,min,minlength,multiple,muted,name,nonce,noshade,novalidate,nowrap,open,optimum,pattern,placeholder,playsinline,poster,preload,pubdate,radiogroup,readonly,rel,required,rev,reversed,role,rows,rowspan,spellcheck,scope,selected,shape,size,sizes,span,srclang,start,src,srcset,step,style,summary,tabindex,target,title,translate,type,usemap,valign,value,width,xmlns,slot".split(","),svg:"accent-height,accumulate,additive,alignment-baseline,ascent,attributename,attributetype,azimuth,basefrequency,baseline-shift,begin,bias,by,class,clip,clippathunits,clip-path,clip-rule,color,color-interpolation,color-interpolation-filters,color-profile,color-rendering,cx,cy,d,dx,dy,diffuseconstant,direction,display,divisor,dur,edgemode,elevation,end,fill,fill-opacity,fill-rule,filter,filterunits,flood-color,flood-opacity,font-family,font-size,font-size-adjust,font-stretch,font-style,font-variant,font-weight,fx,fy,g1,g2,glyph-name,glyphref,gradientunits,gradienttransform,height,href,id,image-rendering,in,in2,k,k1,k2,k3,k4,kerning,keypoints,keysplines,keytimes,lang,lengthadjust,letter-spacing,kernelmatrix,kernelunitlength,lighting-color,local,marker-end,marker-mid,marker-start,markerheight,markerunits,markerwidth,maskcontentunits,maskunits,max,mask,media,method,mode,min,name,numoctaves,offset,operator,opacity,order,orient,orientation,origin,overflow,paint-order,path,pathlength,patterncontentunits,patterntransform,patternunits,points,preservealpha,preserveaspectratio,primitiveunits,r,rx,ry,radius,refx,refy,repeatcount,repeatdur,restart,result,rotate,scale,seed,shape-rendering,specularconstant,specularexponent,spreadmethod,startoffset,stddeviation,stitchtiles,stop-color,stop-opacity,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke,stroke-width,style,surfacescale,systemlanguage,tabindex,targetx,targety,transform,text-anchor,text-decoration,text-rendering,textlength,type,u1,u2,unicode,values,viewbox,visibility,version,vert-adv-y,vert-origin-x,vert-origin-y,width,word-spacing,wrap,writing-mode,xchannelselector,ychannelselector,x,x1,x2,xmlns,y,y1,y2,z,zoomandpan".split(",")}}function ke(){return{a:!0,area:!0,audio:!1,br:!0,base:!0,body:!0,button:!0,canvas:!0,dl:!0,data:!0,datalist:!0,div:!0,em:!0,embed:!1,fieldset:!0,font:!1,footer:!0,form:!1,hr:!0,head:!0,header:!0,output:!0,iframe:!1,frameset:!1,img:!0,input:!0,li:!0,label:!0,legend:!0,link:!0,map:!0,mark:!0,menu:!0,media:!0,meta:!0,nav:!0,meter:!0,ol:!0,object:!1,optgroup:!0,option:!0,p:!0,param:!0,picture:!0,pre:!0,progress:!1,quote:!0,script:!1,select:!0,source:!0,span:!0,style:!0,caption:!0,td:!0,col:!0,table:!0,tr:!0,template:!1,textarea:!0,time:!0,title:!0,track:!0,details:!0,ul:!0,video:!0,del:!0,ins:!0,slot:!0,blockquote:!0,svg:!0,dialog:!0,summary:!0,main:!0,address:!0,colgroup:!0,tbody:!0,tfoot:!0,thead:!0,th:!0,dd:!0,dt:!0,figcaption:!0,figure:!0,i:!0,b:!0,code:!0,h1:!0,h2:!0,h3:!0,h4:!0,abbr:!0,bdo:!0,dfn:!0,kbd:!0,q:!0,rb:!0,rp:!0,rt:!0,ruby:!0,s:!0,strike:!0,samp:!0,small:!0,strong:!0,sup:!0,sub:!0,u:!0,var:!0,wbr:!0,nobr:!1,tt:!0,noscript:!0,comment:!0}}function Pe(){return["#logBox{min-width:0px;max-width:0px;min-height:0px;max-height:0px;,width:0;height:0;z-index:-1;border:none;padding:0px;overflow:hidden;transition:all 0.3s ease;margin-top:-100px;}","#logBox.visible{background-color:rgb(255, 255, 224);z-index:1;position:static;border:1px dotted rgb(153, 153, 153);max-width:50vw;min-width:30vw;min-height:10vh;max-height:90vh;overflow:auto;width:50vw;height:20vh;margin:1rem 0px;padding:0px 8px 19px;resize:both;}","#logBox.visible .legend{position:absolute;}","#logBox .legend{text-align:center;margin-top:-1em;width:inherit;max-width:inherit;}","#logBox .legend div{text-align:center;display:inline-block;max-width:inherit;height:1.2rem;background-color:rgb(119, 119, 119);padding:2px 10px;color:rgb(255, 255, 255);box-shadow:rgb(119 119 119) 2px 1px 10px;border-radius:4px;}","#logBox .legend div:before{content:'JQL Logging (chronological)';}","#logBox .legend.reversed div:before{content:'JQL Logging (reversed)';}","#logBox #jql_logger{marginTop:0.7rem;lineHeight:1.4em;font-family:consolas,monospace;whiteSpace:pre-wrap;maxWidth:inherit;padding-left:100px;}","#logBox #jql_logger div.entry{text-indent:-100px;whiteSpace:normal;}"]}function Je(){return[".popupContainer{position:fixed;inset:-5000px;opacity:0;height:0;width:0;background:rgba(0,0,0,0.1);transition:opacity 0.6s ease-in-out 0s;}",".popupContainer.popup-active{opacity:1;inset:0;height:auto;width:auto;}",".popupContainer .content{box-shadow:rgba(0,0,0,0.5) 2px 2px 8px;border-radius:3px;min-width:125px;max-width:40vw;max-height:40vh;padding:8px;overflow:auto;background:#FFF;z-index:inherit;opacity:1;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);}",".popupContainer .content .popup-warn{position:relative;padding:3px 8px 0 8px;color:red;margin:6px -8px -4px -8px;text-align:center;display:none;}",".popupContainer .content.popup-warn-active .popup-warn{display:block;border-top:1px dashed rgb(0,0,0);}",`.closeHandleIcon{z-index:1;position:absolute;opacity:0;cursor:pointer;width:24px;height:24px;background:${De} no-repeat;}`,".closeHandleIcon.popup-active{opacity:1;}","@media screen and (width < 1200px){.popupContainer .content{max-width:75vw;}}","@media screen and (width < 640px){.popupContainer .content{max-width:90vw;max-height:60vw;}}"]}var K=!1,Be={on:()=>K=!0,off:()=>K=!1},N={tagsRaw:q,allowUnknownHtmlTags:Be,isAllowed(e){if(K)return!0;let t=e?.nodeName.toLowerCase()||"none";return!!q[t]},allowTag:e=>q[e.toLowerCase()]=!0,prohibitTag:e=>q[tag.toLowerCase()]=!1};var Qe=!1,G={data:/data-[\-\w.\p{L}]/ui,validURL:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,whiteSpace:/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g,notAllowedValues:/javascript|injected|noreferrer|alert|DataURL/gi},ze=e=>{if(Qe&&Object.keys(e.removed).length){let t=Object.entries(e.removed).reduce((r,[n,o])=>[...r,`${n} => ${o}`],[]).join("\\000A");console.info("JQL HTML creation errors:"),console.info(t)}},he=e=>{let t=document.createElement("template"),r={rawHTML:e.outerHTML,removed:{}};t.innerHTML=`<div id="placeholder">${e.outerHTML}</div>`;let n=t.content.querySelector("#placeholder");return n.childNodes.forEach(o=>{let i=c(o,SVGElement)?z.svg:z.html;[...o.attributes].forEach(h=>{let u=h.name.trim().toLowerCase(),L=h.value.trim().toLowerCase().replace(G.whiteSpace,""),$=u==="href"?!G.validURL.test(L):G.notAllowedValues.test(L),S=u.startsWith("data")?!G.data.test(u):!!i[u];($||S)&&(r.removed[`${h.name}`]=`attribute/property (-value) not allowed, remove (value: ${Z(h.value||"none",60)})`,o.removeAttribute(h.name))}),N.isAllowed(o)||(r.removed[`<${o.nodeName.toLowerCase()}>`]=`not allowed, not rendered (tag: ${Z(o.outerHTML,60)})`,o.remove())}),ze(r),n.children[0]};var H={BeforeBegin:"beforebegin",AfterBegin:"afterbegin",BeforeEnd:"beforeend",AfterEnd:"afterend"},ee=document.createElement("div"),qe=e=>(ee.innerHTML=e.trim(),ee.childNodes.length?he(ee):void 0),_e=(e,t,r)=>c(e,Comment)?t.insertAdjacentHTML(r,`<!--${e.data}-->`):t.insertAdjacentText(r,e.data),k=(e=[],t=document.body,r=H.BeforeEnd)=>e.reduce((n,o)=>{let i=j(o)&&te(o,t,r);return i?[...n,i]:n},[]),te=(e,t=document.body,r=H.BeforeEnd)=>(t=t?.isJQL?t?.[0]:t,c(e,Comment,Text)?_e(e,t,r):t.insertAdjacentElement(r,e)),M=e=>{e=e.trim();let t=e.split(/<!text>/i);if(e.startsWith("<!--")&&e.endsWith("-->"))return document.createComment(e.replace(/<!--|-->$/g,""));if(t.length>1)return document.createTextNode(e.replace(t[1]));if(!/^<(.+)[^>]+>/m.test(e))return document.createTextNode(e);let r=qe(e);return r.childNodes.length?r.children[0]:M(`<span data-jqlcreationerror="1">${I(e,60)}</span>`)};var oe=!1,W=!1,_=!0,ie=!1,We=!0,se,D="#jql_logger",Ue=e=>{Y?.forEach(t=>e(t))},xe=()=>{Y&&Ue(se);let e=We?"div":"pre",t=`<div id="logBox"><div class="legend"><div></div></div><${e} id="jql_logger"></${e}></div>`;return te(M(t),void 0,H.AfterBegin),f.node(D)},ye=e=>c(e,String)&&Object.assign(document.createElement("textarea"),{innerHTML:e}).textContent||e,R=(...e)=>{let t=e[0]==="fromStatic";if(e=t?e.slice(1):e,t&&!W)return e.forEach(n=>console.info(`${P()} \u2714 ${ye(n)}`));if(!W)return;se=f.createStyle("JQLLogCSS"),!_&&!f.node("#jql_logger")&&(se=f.createStyle("JQLLogCSS"),xe());let r=n=>`${c(n,Object)?JSON.stringify(n,null,2):n}
`;e.forEach(n=>_?console.info(`${P()} \u2714 ${ye(n)}`):f.node("#jql_logger").insertAdjacentHTML(ie?"afterbegin":"beforeend",`<div class="entry">${P()} ${r(n.replace(/\n/g,"<br>"))}</div>`))},re={on(){W=!0,R("Logging activated")},off(){W=!1,console.log("Logging deactivated")}},ne={on(){oe=!0},off(){oe=!1}},J=(...e)=>oe&&R(...e),F={isOn:()=>W,isVisible:()=>f("#jql_logger").is("visible"),on:()=>(re.on(),ne.on(),_||(f.node(D)||xe())?.parentNode.classList.add("visible"),R("Debug logging started. Every call to [jql instance] is logged"),F),off:()=>{let e=f(D);return e.isEmpty||(ne.off(),R("Debug logging stopped"),e.parent.removeClass("visible")),re.off(),F},toConsole:{on:()=>(_=!0,R("Started logging to console"),F),off(){return R("Stopped logging to console (except error messages)"),_=!1,F}},remove:()=>(re.off(),ne.off(),f(D)?.remove(),console?.clear(),console.log(`${P()} logging completely disabled and all entries removed`),F),log:(...e)=>(R(...e),F),hide:()=>(f(D)?.parent?.removeClass("visible"),F),show:()=>(f(D)?.parent?.addClass("visible"),F),reversed:{on:()=>(ie=!0,R("Reverse logging set: now logging bottom to top (latest first)"),f("#logBox .legend").addClass("reversed"),F),off:()=>(ie=!1,f("#logBox .legend").removeClass("reversed"),R("Reverse logging reset: now logging chronological (latest last)"),F)},clear:()=>(f(D)?.text(""),console.clear(),R("Logging cleared"),F)};var c=be;function be(e,...t){let r=["NaN","null","undefined"],n=h=>typeof h=="symbol"?Symbol:h;return t.length>1?l(e,...t):o();function o(){let h=n(e),u=t.length>0;return t=u&&t.shift(),u&&i(t)?`${h}`==`${t}`:e===!1?t===Boolean?!0:"Boolean":$();function $(){let S=e===0?Number:e===""?String:h?Object.getPrototypeOf(e)?.constructor:{name:`${h}`};return t?t===S||t===Object.getPrototypeOf(S)||`${t}`===S?.name:S?.name}}function i(h){for(let u of r)if(u===`${h}`)return!0;return!1}function l(h,...u){for(let L of u)if(be(h,L))return!0;return!1}}var Ve=[...Array(26)].map((e,t)=>String.fromCharCode(t+65)).concat([...Array(26)].map((e,t)=>String.fromCharCode(t+97))).concat([...Array(10)].map((e,t)=>`${t}`));var X=(e,t=2)=>`${e}`.padStart(t,"0");var Ge=(e,t=0)=>([e,t]=[Math.floor(e),Math.ceil(t)],Math.floor([...crypto.getRandomValues(new Uint32Array(1))].shift()/2**32*(e-t+1)+t)),Ze=e=>{let t=e.length;for(;t--;){let r=Ge(t);[e[t],e[r]]=[e[r],e[t]]}return e};var I=(e,t=120)=>`${e}`.trim().slice(0,t).replace(/>\s+</g,"><").replace(/</g,"&lt;").replace(/\s{2,}/g," ").replace(/\n/g,"\\n")+(e.length>t?" &hellip;":"").trim(),B=e=>e.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`).replace(/^-|-$/,""),Xe=([e,...t])=>`${e.toUpperCase()}${t.join("")}`,ve=e=>c(e,String)?e.toLowerCase().split("-").map((t,r)=>r&&`${Xe(t)}`||t).join(""):e,U=()=>`_${Ze(Ve).slice(0,8).join("")}`,Z=(e,t=120)=>I(e,t).replace(/&lt;/g,"<"),P=()=>(e=>`[${X(e.getHours())}:${X(e.getMinutes())}:${X(e.getSeconds())}.${X(e.getMilliseconds(),3)}]`)(new Date);var Le=e=>e.replace(/</g,"&lt;");function Ee(){let e=function(i){if(!i)return;let l=i.style,h=getComputedStyle(i),u=[l.visibility,h.visibility].includes("hidden"),L=[l.display,h.display].includes("none"),$=i.offsetTop<0||i.offsetLeft+i.offsetWidth<0||i.offsetLeft>document.body.offsetWidth,S=+h.opacity==0||+(l.opacity||1)==0;return!($||S||L||u)},t=function(i){return!!f.nodes(":is(:read-write)",i.parentNode).find(l=>l===i)},r=function(i){return!!f.nodes(":is(:modal)",i.parentNode).find(l=>l===i)},n="n/a",o={writable:n,modal:n,empty:!0,open:n,visible:n};return i=>{let l=i[0];return l?{get writable(){return t(l)},get modal(){return r(l)},get open(){return l.open},get visible(){return e(l)},get disabled(){return l.hasAttribute("readonly")||l.hasAttribute("disabled")},get empty(){return!1},get virtual(){return i.isVirtual}}:o}}var E=(e,t)=>{let r=e.collection.filter(n=>!le(n));for(let n=0;n<r.length;n+=1)t(r[n],n);return e},Ye=Ee(),Se=e=>e&&(e.textContent=""),Ke=(e,t)=>e.toLowerCase().trim()===t.trim().toLowerCase(),we=(e,t)=>{e&&c(t,Object)&&Object.entries(t).forEach(([r,n])=>e.setAttribute(`data-${B(r)}`,n))},Ce=e=>z.html.find(t=>e===t),et=(e,t,r)=>{r&&c(t,String)&&(t={[t]:r==="-"?"":r});let n;t.className&&(n=t.className,delete t.className),n=[...e.classList].find(i=>i.startsWith("JQLClass-")||n&&i===n)||n||`JQLClass-${U().slice(1)}`,f.editCssRule(`.${n}`,t),e.classList.add(n)},tt=(e,t)=>{e&&Object.entries(t).forEach(([r,n])=>{if(r.toLowerCase().startsWith("data"))return we(e,n);if(Ke(r,"class"))return n.split(/,/).forEach(o=>e.classList.add(`${o.trim()}`));if(c(n,String)&&Ce(r))return e[r]=n})},ae=(e,t)=>{c(t,Object)&&Object.entries(t).forEach(([r,n])=>{let o;/!important/i.test(n)&&(n=n.slice(0,n.indexOf("!")).trim(),o="important"),e.style.setProperty(B(r),n,o)})},rt={get(e,t){return e[ve(t)]||e[t]}},nt={factoryExtensions:{is:e=>Ye(e),length:e=>e.collection.length,dimensions:e=>e.first()?.getBoundingClientRect(),parent:e=>{let t=f(e[0]?.parentNode);return t.is.empty?e:t},outerHtml:e=>(e.first()||{outerHTML:void 0}).outerHTML,data:e=>({get all(){return new Proxy(e[0]?.dataset??{},rt)},get:(t,r)=>e.data.all[t]??r,add:(t={})=>(!e.is.empty&&c(t,Object)&&Object.entries(t).forEach(([r,n])=>e.setData({[r]:n})),e),remove:t=>(e[0]?.removeAttribute(`data-${B(t)}`),e)}),Style:e=>({get computed(){return e.is.empty?{}:getComputedStyle(e[0])},inline:t=>e.style(t),inSheet:t=>e.css(t),valueOf:t=>e.is.empty?void 0:getComputedStyle(e[0])[B(t)],byRule:({classes2Apply:t=[],rules:r=[]}={})=>((r?.length||t?.length)&&(r?.length&&f.editCssRules(...r),t?.forEach(n=>e.addClass(n))),e)}),HTML:e=>({get:(t,r)=>{if(e.is.empty)return"NO ELEMENTS IN COLLECTION";let n=t?e.outerHtml:e.html();return r?Le(n):n},replace:t=>(e.is.empty||e.html(t),e),append:t=>(e.is.empty||e.html(t,!0),e),insert:t=>(e.is.empty||e.html(`${t.isJQL?t.HTML.get(!0):t}${e.HTML.get()}`),e)})},instanceExtensions:{isEmpty:e=>e.collection.length<1,replaceClass:(e,t,...r)=>E(e,n=>{n.classList.remove(t),r.forEach(o=>n.classList.add(o))}),removeClass:(e,...t)=>E(e,r=>r&&t.forEach(n=>r.classList.remove(n))),addClass:(e,...t)=>E(e,r=>r&&t.forEach(n=>r.classList.add(n))),setData:(e,t)=>E(e,r=>we(r,t)),show:e=>E(e,t=>ae(t,{display:"revert-layer !important"})),hide:e=>E(e,t=>ae(t,{display:"none !important"})),empty:e=>E(e,Se),clear:e=>E(e,Se),closest:(e,t)=>{let r=c(t,String)?e[0].closest(t):null;return r?f(r):e},style:(e,t,r)=>E(e,o=>{r&&c(t,String)&&(t={[t]:r||"none"}),ae(o,t)}),toggleClass:(e,t)=>E(e,r=>r.classList.toggle(t)),css:(e,t,r)=>E(e,n=>et(n,t,r)),text:(e,t,r=!1)=>e.isEmpty()?e:c(t,String)?E(e,o=>o.textContent=r?o.textContent+t:t):e.first().textContent,removeAttribute:(e,t)=>E(e,r=>r.removeAttribute(t)),each:(e,t)=>E(e,t),remove:(e,t)=>{let r=o=>o.remove(),n=()=>e.collection=e.collection.filter(o=>document.documentElement.contains(o));if(t){let o=e.find$(t);return o.is.empty||(E(o,r),n()),e}return E(e,r),n(),e},computedStyle:(e,t)=>e.first()&&getComputedStyle(e.first())[t],getData:(e,t,r)=>e.first()&&e.first().dataset?.[t]||r,hasClass:(e,...t)=>{let r=e[0];return!r||!r.classList.length?!1:t.find(n=>r.classList.contains(n))&&!0||!1},replace:(e,t,r)=>{let n=e.first();return!t||!r?(console.error("JQL replace: nothing to replace"),e):(r.isJQL&&(r=r.first()),c(r,NodeList)&&(r=r[0]),n&&t&&(t=c(t,String)?n.querySelectorAll(t):t.isJQL?t.collection:t,c(t,HTMLElement,NodeList,Array)&&c(r,HTMLElement)&&(c(t,HTMLElement)?[t]:[...t]).forEach(o=>o.replaceWith(r.cloneNode(!0)))),e)},replaceMe:(e,t)=>(t=c(t,HTMLElement)?f(t):t,e.parent.replace(e,t),f(t)),val:(e,t)=>{let r=e[0];return!r||!c(r,HTMLInputElement,HTMLSelectElement,HTMLTextAreaElement)?e:t===void 0?r.value:(r.value=c(t,String)?t:"",e)},attr:(e,t,r)=>!r&&c(t,String)?t==="class"?[...e[0]?.classList].join(" "):e[0]?.getAttribute(t):(c(t,String)&&r&&(t={[t]:r}),c(t,Object)&&!e.is.empty&&tt(e[0],t),e),append:(e,...t)=>{if(!e.is.empty&&t.length)for(let r of t){if(c(r,String)){let n=!/^<.+>$/m.test(r.trim());E(e,o=>o.append(n?f.text(r):M(r)))}if(j(r)){let n=r;e.length>1&&(n=r,n.removeAttribute&&n.removeAttribute("id")),E(e,o=>o.append(n))}if(r.isJQL&&!r.is.empty){let n=e.length>1?r.duplicate().collection:r.collection;E(e,o=>o.append(...n))}}return e},prepend:(e,...t)=>{if(!e.isEmpty()&&t)for(let r of t){if(c(r,String)){let n=!/^<.+>$/m.test(r.trim());E(e,o=>o.prepend(n?f.text(r):M(r)))}if(j(r)){let n=r;e.length>1&&(n=r.cloneNode(!0),n.removeAttribute&&n.removeAttribute("id")),E(e,o=>o.insertBefore(n,o.firstChild))}if(r.isJQL&&!r.is.empty){let n=e.length>1?r.duplicate().collection:r.collection;E(e,o=>o.prepend(...n))}}return e},appendTo:(e,t)=>(t.isJQL||(t=f(t)),t.append(e)),prependTo:(e,t)=>(t.isJQL||(t=f.virtual(t)),t.prepend(e)),single:(e,t)=>e.collection.length>0?c(t,String)?e.find$(t):c(t,Number)?f(e.collection[t]):f(e.collection[0]):e,toNodeList:e=>[...e.collection].map(t=>document.importNode(t,!0)),duplicate:(e,t=!1,r=document.body)=>{let n=e.toNodeList().map(i=>i.removeAttribute&&i.removeAttribute("id")||i),o=f.virtual(n);return t?o.toDOM(r):o},toDOM:(e,t=document.body,r=H.BeforeEnd)=>(e.collection=k(e.collection,t,r),e.isVirtual&&(e.isVirtual=!1),e),first:(e,t=!1)=>{if(e.collection.length>0)return t?e.single():e.collection[0]},first$:(e,t)=>e.single(t),find:(e,t)=>e.first()?.querySelectorAll(t)||[],find$:(e,t)=>{let r=e.collection.reduce((n,o)=>[...n,[...o.querySelectorAll(t)]],[]).flat().filter(n=>c(n,HTMLElement));return r.length&&f(r)||f()},prop:(e,t,r)=>r&&!Ce(t)?e:r?E(e,n=>n[t]=r):e[0]?.[t],on:(e,t,...r)=>(e.collection.length&&r?.forEach(n=>{let o=$e(e);f.delegate(t,o,n)}),e),html:(e,t,r)=>{if(t===void 0)return e[0]?.innerHTML;if(!e.isEmpty()){let n=M(`<div>${t.isJQL?t.HTML.get(!0):t}</div>`);if(!c(n,Comment))return E(e,i=>i.innerHTML=r?i.innerHTML+n.innerHTML:n.innerHTML)}return e},htmlFor:(e,t,r="",n=!1)=>{if(t&&e.collection.length){let o=e.find$(t);if(!o)return e;if("{htmlValue}".trim().length<1)return o.textContent="",e;let i=M(`<div>${r}</div>`);i&&o.html(i.innerHTML,n)}return e},trigger:(e,t,r=Event,n={})=>{if(e.collection.length){let o=new r(t,{...n,bubbles:n.bubbles??!0});for(let i of e.collection)i.dispatchEvent(o)}return e}}},ce=nt;var Ae=ot;function ot(e){let t=e.createStyle("JQLPopupCSS");fe.forEach(a=>t(a));let r,n,o,i,l=e.virtual('<div class="popup-warn">'),h=e('<div class="popupContainer">').append(e('<span class="closeHandleIcon">')).append(e('<div class="content">')),[u,L]=[e(".popupContainer > .closeHandleIcon"),e(".popupContainer > .content")],$=()=>{if(u.hasClass("popup-active")){let{x:a,y:p,width:b}=L.dimensions;u.style({top:`${p-12}px`,left:`${a+b-12}px`})}},S=(a,p=!1)=>{let b=p?a.min-100:a.max+10;h.style({zIndex:b}),u.style({zIndex:b+1})},w=()=>{o&&e(".popup-warn").clear().append(e(`<div>${o}</div>`)),L.addClass("popup-warn-active")},g=()=>{r=!1,A(u[0])},m=()=>{let a=[0,...e.nodes("*:not(.popupContainer, .closeHandleIcon)",document.body).map(p=>+getComputedStyle(p).zIndex).filter(p=>e.IS(p,Number))];return{max:Math.max(...a)??0,min:Math.min(...a)??0}},y=(a,p)=>i=setTimeout(()=>A(u[0]),+a*1e3);return S(m(),!0),e.delegate("click",".popupContainer, .closeHandleIcon",a=>A(a.target)),e.delegate("click",".popupContainer .content",(a,p)=>r&&p.removeClass("popup-warn-active")),e.delegate("resize",$),{show:x,create:(a,p,b,C)=>{let s=e.IS(p,Boolean)?p:!1;x({content:a,modal:s,callback:s?b:p,warnMessage:C})},createTimed:(a,p,b)=>x({content:a,closeAfter:p,callback:b}),removeModal:g};function x({content:a,modal:p,closeAfter:b,callback:C,warnMessage:s}){return a?(clearTimeout(i),S(m()),r=p??!1,o=e.IS(s,String)&&`${s?.trim()}`.length||s?.isJQL?s:void 0,L.clear().append(a.isJQL?a:e(`<div>${a}</div>`)),r&&s&&L.append(l.duplicate()),h.addClass("popup-active"),e.IS(C,Function)&&(n=()=>{C(),n=null}),r||(e.IS(+b,Number)&&y(b,n),u.addClass("popup-active"),$()),!0):console.error("Popup creation needs at least some text to show")}function A(a){if(!r&&!a.closest(".content")){clearTimeout(i),L.clear(),e(".popup-active").removeClass("popup-active"),S(m(),!0),e.IS(n,Function)&&n(),o="";return}return r&&w()}}var O={},it=["load","unload","scroll","focus","blur","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","loadstart","progress","error","abort","load","loadend","pointerenter","pointerleave","readystatechange"],st=e=>!!it.find(t=>t===e),Te=()=>{let e=n=>O[n.type].forEach(o=>o(n)),t=(n,o)=>i=>{let l=i.target?.closest?.(n);return l&&o(i,f(l))},r=(n,o)=>{O[n]||addEventListener(n,e,st(n))};return(n,o,i,l=!1)=>{r(n,l);let h=o?t(o,i):i;O=O[n]?{...O,[n]:O[n].concat(h)}:{...O,[n]:[h]}}};var ue=at;function at({styleSheet:e,createWithId:t}){let{cssRuleFromText:r,checkAtRules:n,toDashedNotation:o,IS:i,shortenRule:l,consider:h,ruleExists:u,checkParams:L,atMedia2String:$,sheet:S,compareSelectors:w}=ct({styleSheet:e,createWithId:t}),g=(a,p)=>{if(a&&p.removeProperties){Object.keys(p.removeProperties).forEach(b=>{a.style.removeProperty(b)});return}Object.entries(p).forEach(([b,C])=>{let s;/!important/.test(C)&&(C=C.slice(0,C.indexOf("!important")).trim(),s="important"),a.style.setProperty(o(b),C,s)})},m=(a,p,b=S)=>{if(!i(a,String)||!a.trim().length||/[;,]$/g.test(a.trim()))return console.error(`StylingFactory instance (setRules): [${a||"[no selector given]"}] is not a valid selector`);let C=u(a,!0),s=C||b.cssRules[b.insertRule(`${a} {}`,b.cssRules.length||0)];if(p.removeRule){if(!C)return console.error(`Remove rule: ${a} does not exist`);let d=[...S.rules].findIndex(v=>w(v.selectorText||"",a));return h(()=>S.deleteRule(d))}return h(()=>g(s,p),a,C)},y=a=>{let p=a.trim().split(/{/,2),b=p.shift().trim();if(!i(b,String)||!b.trim())return console.error(`StylingFactory instance (doParse): no (valid) selector could be extracted from rule ${l(a)}`);let C=r(p.shift());return m(b,C)},x=a=>{let p=n(a);return p.done?p.existing:y(a)},A=(a,p)=>a.trim().startsWith("@media")?x($(a,p)):m(a,p);return(a,p={})=>L(a,p)&&(Object.keys(p).length?A(a,p):x(a))}function ct({styleSheet:e,createWithId:t}){let r="Note: The rule or some of its properties may not be supported by your browser (yet)",n=s=>s.replace(/([*\[\]()-+{}.$?\\])/g,"\\$1");e=t?(s=>document.querySelector(`#${s}`)?.sheet??document.head.insertAdjacentElement("beforeend",Object.assign(document.createElement("style"),{id:s,type:"text/css"})).sheet)(t):e;let i=(s,...d)=>{let v=d.length&&Array.isArray(d.slice(-1))?d.pop().join(""):"";return new RegExp((d.length&&s.raw.reduce((T,V,je)=>T.concat(d[je-1]||"").concat(V),"")||s.raw.join("")).split(`
`).map(T=>T.replace(/\s|\/\/.*$/g,"").trim().replace(/(@s!)/g," ")).join(""),v)},l=(s,d)=>[...e.rules].find(v=>d?y(v.selectorText||"",s):i`${n(s)}${[..."gim"]}`.test(v.cssText)),h=s=>/@import|@charset|@font-face/i.test(s)?{existing:a(s,0),done:!0}:$.test(s)?{ok:a(s,e.cssRules.length),done:!0}:{ok:!1,done:!1},u=(s,...d)=>!!d.find(v=>L(s,v)),L=(s,...d)=>{if(d.length>1)return u(s,...d);d=d.shift();let v="Invalid parameter(s)",T=s===0?Number:s===""?String:s?Object.getPrototypeOf(s)?.constructor:{name:v};return d?d===T?.__proto__||d===T:T?.name??v},$=i`@keyframes | @font-feature-values | @font-palette-values 
    | @layer | @namespace | @page | @counter-style | @container | @media ${["i"]}`,S=s=>s.reduce((d,v)=>{let[T,V]=[v.slice(0,v.indexOf(":")).trim(),v.slice(v.indexOf(":")+1).trim().replace(/;$|;.+(?=\/*).+\/$/,"")];return T&&V?{...d,[T]:V}:d},{}),w=s=>s.replace(/[}{\r\n]/g,"").split(";").map(d=>d.trim()).join(`;
`).split(`
`),g=s=>S(w(s)),m=s=>s.replace(/[A-Z]/g,d=>`-${d.toLowerCase()}`).replace(/[^--]^-|-$/,""),y=(s,d)=>s?.replace("::",":")===d?.replace("::",":"),x=(s,d)=>s&&L(s,String)&&s.trim().length&&L(d,Object)||(console.error("StylingFactory instance called with invalid parameters"),!1),A=s=>{let d=(s||"NO RULE").trim().slice(0,50).replace(/\n/g,"\\n").replace(/\s{2,}/g," ");return s.length>d.length?`${d.trim()}...truncated`:d},a=s=>{s=s.trim();let d=!!l(s.slice(0,s.indexOf("{")));try{return e.insertRule(`${s}`,e.cssRules.length),d}catch(v){return console.error(`StylingFactory instance (tryParse) ${v.name} Error:
${v.message}
Rule: ${A(s)}
${r}`),d}},p=(s,d,v)=>{try{return s(),v}catch(T){return console.error(`StylingFactory instance (tryAddOrModify) ${T.name} Error:
${T.message}
Rule: ${A(d)}
${r}`),v}},b=s=>Object.entries(s).map(([d,v])=>`${d}: ${v.trim()}`).join(`;
`);return{sheet:e,cssRuleFromText:g,checkAtRules:h,ruleExists:l,atMedia2String:(s,d)=>`${s.trim()} ${Object.entries(d).map(([v,T])=>`${v}: { ${b(T)}`)}`,compareSelectors:y,toDashedNotation:m,checkParams:x,tryParse:a,consider:p,IS:L,shortenRule:A}}var me=ce.instanceExtensions,He=ce.factoryExtensions,le=e=>c(e,Comment,Text),j=e=>c(e,Text,HTMLElement,Comment),lt=e=>c(e,Comment);var pe=e=>c(e,String)&&/^<|>$/.test(`${e}`.trim()),Fe=e=>c(e,Array)&&!e?.find(t=>!pe(t)),ge=e=>c(e,Array)&&!e?.find(t=>!j(t)),Re=e=>e?.filter(t=>t).reduce((t,r)=>t.concat(lt(r)?`<!--${r.textContent}-->`:le(r)?r.textContent:r.outerHTML),""),Me=e=>e?c(e,NodeList)?[...e]:j(e)?[e]:ge(e)?e:e.isJQL?e.collection:void 0:[],Ie=(e,t,r)=>{let n=t!==document.body&&c(e,String)&&e.toLowerCase()!=="body"?t:document,o;try{r.collection=[...n.querySelectorAll(e)]}catch{o=`Invalid CSS querySelector. [${e}]`}return o??`CSS querySelector "${e}", output ${r.collection.length} element(s)`},$e=e=>{let t=e.data.get("hid")||`HID${U()}`;return e.data.add({hid:t}),`[data-hid="${t}"]`},Q=e=>{let t=i=>(...l)=>c(i,Function)&&i(Q(e),...l),r=i=>(...l)=>c(i,Function)?{tmpKey:i(Q(e),...l)}:{tmpKey:void 0},n=(i,l)=>c(l,Symbol)?"nothing":c(+l,Number)?i.collection?.[l]:l in He?r(He[l])().tmpKey:l in me?t(me[l]):i[l],o={get:(i,l)=>n(i,l)};return new Proxy(e,o)},de=ue({createWithId:"JQLStylesheet"}),ut=(e,t)=>me[e]=(r,...n)=>t(r,...n),dt,mt,Ne=e=>{let t=pt(e);return Object.entries(Object.getOwnPropertyDescriptors(t)).forEach(([r,n])=>{Object.defineProperty(e,r,n)}),dt={...t},e};function pt(e){let t={activePopup:void 0},r=document.createElement("br"),n=(...g)=>g.forEach(m=>de(m)),o=(g,m)=>de(g,m),i=(g,m,y)=>{m=m?.isJQL?m?.[0]:m,y=y&&Object.values(H).find(A=>y===A)?y:void 0;let x=e(g,r);return m&&x.collection.forEach(A=>y?m.insertAdjacentElement(y,A):m.append(A)),x},l=Te(),h=(g,m,...y)=>(c(m,Function)&&(y.push(m),m=void 0),y.forEach(x=>l(g,m,x))),u=Object.entries(N.tagsRaw).reduce(S,{});return mt=Object.entries(N.tagsRaw).filter(([,g])=>g).map(([g])=>g).sort((g,m)=>g.localeCompare(m)),w(u,(g=>({debugLog:F,log:(...y)=>R("fromStatic",...y),insertPositions:H,get at(){return H},editCssRules:n,editCssRule:o,setStyle:o,delegate:h,virtual:i,get fn(){return ut},get allowTag(){return N.allowTag},get prohibitTag(){return N.prohibitTag},get lenient(){return N.allowUnknownHtmlTags},get IS(){return c},popup:()=>g.Popup,get Popup(){return g.activePopup||(g.activePopup=Ae(g)),g.activePopup},createStyle:y=>ue({createWithId:y||`jql${U()}`}),removeCssRule:(...y)=>y.forEach(x=>de(x,{removeRule:1})),text:(y,x=!1)=>x?document.createComment(y):document.createTextNode(y),node:(y,x=document)=>x.querySelector(y,x),nodes:(y,x=document)=>[...x.querySelectorAll(y,x)]}))(e));function S(g,[m,y]){return y&&(Object.defineProperty(g,m,{get(){return m==="comment"?x=>e(document.createComment(x)):x=>e.virtual(document.createElement(m)).html(x??"")}}),Object.defineProperty(g,m.toUpperCase(),{get(){return m==="comment"?x=>e(document.createComment(x)):e.virtual(document.createElement(m))}})),g}function w(...g){let m={};for(let y of g){let x=Object.getOwnPropertyDescriptors(y);Object.entries(x).forEach(([A,a])=>Object.defineProperty(m,A,a))}return m}}var f=Ne(gt());function gt(){return function(r,n,o=H.BeforeEnd){n=(n&&n?.isJQL?n[0]:n)??document.body,o=o&&Object.values(H).find(w=>o===w)?o:void 0;let i=pe(r),l=Fe(r),h=l||i,u={collection:Me(r)??[],isVirtual:c(n,HTMLBRElement),isJQL:!0},L=ge(u.collection);location.host.startsWith("dev")&&(u.params={virtual:u.isVirtual,jql:u.isJQL,isRawHtml:i,isRawHtmlArray:l,isRawElemCollection:L});let $=`input =&gt; ${l?`"${I(r.join(", "),70)}"`:!h&&L?`element collection [${I(u.collection.map(w=>w.outerHTML||w.textContent).join(", "),70)}]`:`"${I(r,70)}"`}`;if(u.collection.length&&L)return J($),u.collection.forEach(w=>{document.documentElement.contains(w)||k([w],n,o)}),Q(u);if(h){if([r].flat().forEach(w=>u.collection.push(M(w))),u.collection.length>0){let w=u.collection.filter(g=>g?.dataset?.jqlcreationerror);u.collection=u.collection.filter(g=>!g?.dataset?.jqlcreationerror),J(`${$}`),J(`*Created ${u.isVirtual?"VIRTUAL ":""}[${I(Re(u.collection)||"sanitized: no elements remaining",70)}]`),w.length&&console.error(`JQL: illegal html, not rendered: "${w.reduce((g,m)=>g.concat(`${m.textContent}
`),"").trim()}"`),u.isVirtual||k(u.collection,n,o)}return Q(u)}let S=Ie(r,n,u);return J(`input => ${S}`),Q(u)}}export{f as default};
